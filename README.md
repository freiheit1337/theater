# Theater

### Пример создание прод image

```
cpp -E -P -o Dockerfile Dockerfile.in
docker build -t theater .
docker run -it --rm -p <IP>:<PORT>:9760 -e MYSQL_PARAMS='mysql2://root:123321@<DATEBASE_IP>:3313/name' --name theater theater
```

Переменная окружения MYSQL_PARAMS используется для подключения к базе

### Примеры запросов и ответов к апи

```
curl -X POST "http://<IP>:<PORT>:/v1/event" -H "accept: application/json" -H "Content-Type: application/json" -d "{ \"title\": \"qweqwe\", \"start_time\": 123, \"end_time\": 125}"

{"body":{"object":{"start_time":"1970-01-01 00:02:03 +0000","end_time":"1970-01-01 00:02:05 +0000","title":"qweqwe"}}}

curl -X GET "http://<IP>:<PORT>:/v1/event" -H "accept: application/json"

{"body":{"objects":[{"start_time":"1970-01-01 00:02:03 +0000","end_time":"1970-01-01 00:02:05 +0000","title":"qweqwe"}]}}
```

### Создание тестового image для прогонов тестов

```
cpp -E -P -DTEST -o Dockerfile Dockerfile.in
docker build -t theater-test .
docker run -it --rm theater-test
```

Ответы
1) Затрудняюсь без логов докера ответить почему команда docker run упала. Возможно параметры запуска mysql былы не верны, у меня на mac'e и linux'e запустился контейнер

контейнер с тестами должен был запуститься.

- Для чего нужно было использовать именно дебиан?
  - особых причин нет
- Почему нельзя сразу взять образ ruby?
  - да, можно взять образ ruby
- Для чего нужно использовать c++ интерпретатор для запуска докера?
  - чтобы избежать дублирования кода. Используя cpp из одного Dockerfile.in можно сгенерить разные Dockerfile'ы один для контейнера в котором проганяются тесты и прод контейнер в котором запущено приложение

2) Логика работы приложения нам показалась некорректной.

  У нас есть спектакль "Три сестры" идет с 02.04 - 10.04

  И еще спектакль от московской труппы "Волк и семеро козлят" идет с 18.04 - 25.04

  Что произойдет если Оксана Григорьева решила добавить в афишу спектакль "Супница":

- а) 21.03 - 23.03 ?
  - добавится
- б) 01.04 - 05.04 ?
  - не добавится, вернётся 'Already exists'
- в) 06.04 - 09.04 ?
  - не добавится, вернётся 'Already exists'
- г) 12.04 - 17.04 ?
  - не добавится, вернётся 'Already exists'
- д) 23.04 - 28.04 ?
  - не добавится, вернётся 'Already exists'
- е) 29.04 - 30.04 ?
  - добавится

  Ответ предлагается оформить в виде рабочих спеков.
    - добавила спеки

Наверное для решения задачи больше бы подошло использование geo индекса по времени начала и времени конца спектакля
